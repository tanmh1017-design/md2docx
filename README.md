# md2docx: Markdown to Word Converter

<div align="center">

[![Python](https://img.shields.io/badge/Python-3.7%2B-blue.svg)](https://www.python.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](https://opensource.org/licenses/MIT)

</div>

[**English**](#english-version) | [**中文版**](#中文版)

---

## English Version

### 📋 Overview

**md2docx** is a Python script that instantly converts Markdown content from your clipboard into a fully-formatted Microsoft Word (`.docx`) document. It is designed to accurately handle text formatting, LaTeX equations, code blocks, and images.

A key feature of this tool is its ability to use a local Word document (`my_template.docx`) as a style reference, ensuring your output files are consistent with your desired formatting. If no template is provided, it will use Pandoc's default styles.

### ✨ Features

- **Clipboard-Powered**: Directly reads Markdown content from the system clipboard.
- **AI-Ready**: Perfect for converting content generated by AI assistants (e.g., Gemini, ChatGPT) directly into formatted Word documents for reports, essays, or summaries.
- **High-Fidelity Conversion**: Accurately converts Markdown syntax, including headers, lists, bold/italic text, links, and images.
- **LaTeX Support**: Seamlessly renders LaTeX mathematical formulas into professional-looking equations.
- **Optional Style Template**: Automatically applies styles from a `my_template.docx` file if it exists.
- **Timestamped Output**: Saves files with a unique timestamp (e.g., `output_20251004_173000.docx`) to prevent overwriting.
- **Cross-Platform**: Works on Windows, macOS, and Linux.

### ⚙️ Prerequisites

1.  **Python 3**: Download from [python.org](https://www.python.org/).
2.  **Pandoc**: The core conversion engine. Install it from the [Pandoc website](https://pandoc.org/installing.html).
    -   **Important**: Ensure Pandoc is added to your system's `PATH` so it can be called from the terminal.
3.  **Python Libraries**: Install the required packages using pip:
    ```bash
    pip install pypandoc pyperclip
    ```

### 🚀 How to Use

1.  **Clone or Download**: Get the `md2docx.py` script from this repository.
2.  **Copy Markdown**: Copy any Markdown content to your clipboard (e.g., from your text editor or an AI chat).
3.  **Run the Script**: Execute the script from your terminal:
    ```bash
    python md2docx.py
    ```
4.  **Find Your File**: A new `.docx` file will be created in the same directory.

### 🎨 Using a Custom Style Template (Optional)

For consistent formatting, you can provide a custom style template. The recommended way is to generate Pandoc's default template first and then modify it.

**Step 1: Generate the Default Template**

Open your terminal or command prompt and run the following command. This will create a file named `my_template.docx` in your current directory.

```bash
pandoc -o my_template.docx --print-default-data-file reference.docx
```

**Step 2: Customize Your Template**

1.  Open `my_template.docx` in Microsoft Word or another compatible editor.
2.  Modify the styles to match your needs. You can change fonts, sizes, colors, and spacing for elements like:
    -   `Normal` (for body text)
    -   `Heading 1`, `Heading 2`, `Heading 3`, etc.
    -   `Code Block` or `Source Code`
    -   `Body Text`
3.  Save the changes to `my_template.docx`.

**Step 3: Place and Use the Template**

-   Place the modified `my_template.docx` file in the **same directory** as the `md2docx.py` script.
-   Now, whenever you run `python md2docx.py`, the script will automatically detect and apply the styles from your template.

If you want to revert to default styling, simply rename or delete `my_template.docx` from the directory.

### 📄 License

This project is licensed under the MIT License.

---
---

## 中文版

### 📋 简介

**md2docx** 是一个 Python 脚本，可以将剪贴板中的 Markdown 内容即时转换为一个格式精美的 Word (`.docx`) 文档。它被设计用来精准地处理文本格式、LaTeX 公式、代码块和图片。

该工具的一个核心功能是能够使用一个本地的 Word 文档 (`my_template.docx`) 作为样式参考，确保输出文件与你期望的格式保持一致。如果没有提供模板，它将使用 Pandoc 的默认样式。

### ✨ 功能特性

- **剪贴板驱动**：直接从系统剪贴板读取 Markdown 内容。
- **AI 内容友好**：完美适用于将 AI 助手（如 Gemini, ChatGPT）生成的内容直接转换为格式化的 Word 文档，方便用于报告、论文或笔记整理。
- **高保真转换**：精确转换 Markdown 语法，包括标题、列表、粗体/斜体、链接等。
- **LaTeX 支持**：将 LaTeX 数学公式无缝渲染为专业排版的 Word 公式。
- **可选的样式模板**：如果目录下存在 `my_template.docx` 文件，脚本会自动应用其样式。
- **时间戳命名**：输出文件会附带唯一的时间戳（例如 `output_20251004_173000.docx`），防止文件被覆盖。
- **跨平台**：支持 Windows、macOS 和 Linux。

### ⚙️ 环境要求

1.  **Python 3**: 从 [python.org](https://www.python.org/) 下载。
2.  **Pandoc**: 核心转换引擎。请从 [Pandoc 官网](https://pandoc.org/installing.html) 安装。
    -   **重要**: 请确保将 Pandoc 添加到系统的 `PATH` 环境变量中，以便能在终端中调用。
3.  **Python 库**: 使用 pip 安装所需的依赖包：
    ```bash
    pip install pypandoc pyperclip
    ```

### 🚀 如何使用

1.  **克隆或下载**: 获取本仓库的 `md2docx.py` 脚本。
2.  **复制 Markdown**: 将任意 Markdown 内容复制到剪贴板（例如，从你的文本编辑器或 AI 聊天窗口中）。
3.  **运行脚本**: 在终端中执行脚本：
    ```bash
    python md2docx.py
    ```
4.  **查找文件**: 一个新的 `.docx` 文件将会被创建在脚本所在的目录中。

### 🎨 使用自定义样式模板 (可选)

为了获得统一的文档格式，你可以提供一个自定义样式模板。最佳实践是先生成一个 Pandoc 的默认模板，然后在此基础上进行修改。

**第一步：生成默认模板**

打开你的终端（命令提示符或 PowerShell），并运行以下命令。这会在当前目录下创建一个名为 `my_template.docx` 的文件。

```bash
pandoc -o my_template.docx --print-default-data-file reference.docx
```

**第二步：自定义你的模板**

1.  在 Microsoft Word 或其他兼容的编辑器中打开 `my_template.docx`。
2.  修改你需要的样式。你可以为以下元素更改字体、字号、颜色和段落间距：
    -   `正文` (Normal)
    -   `标题 1` (Heading 1), `标题 2` (Heading 2) 等
    -   `代码块` (Code Block / Source Code)
    -   `Body Text`
3.  完成修改后，保存 `my_template.docx` 文件。

**第三步：放置并使用模板**

-   将修改后的 `my_template.docx` 文件放置在与 `md2docx.py` 脚本 **相同的目录** 下。
-   现在，每当你运行 `python md2docx.py`，脚本都会自动检测并应用你模板中的样式。

如果你想恢复使用默认样式，只需从目录中重命名或删除 `my_template.docx` 文件即可。

### 📄 许可证

本项目基于 MIT 许可证开源。
